# Create database objects

```SQL
CREATE DATABASE IF NOT EXISTS TEST_DB;

USE DATABASE TEST_DB;

CREATE WAREHOUSE IF NOT EXISTS TEST_WH WITH WAREHOUSE_SIZE = 'XSMALL' WAREHOUSE_TYPE = 'STANDARD' AUTO_SUSPEND = 60 AUTO_RESUME = TRUE MIN_CLUSTER_COUNT = 1 MAX_CLUSTER_COUNT = 1 SCALING_POLICY = 'STANDARD';

USE WAREHOUSE TEST_WH;

CREATE SCHEMA IF NOT EXISTS EXTERNAL_TABLE;

USE SCHEMA EXTERNAL_TABLE;

CREATE OR REPLACE TABLE "TEST_DB"."EXTERNAL_TABLE"."TEST_TABLE" ("ID" INTEGER, "NAME" STRING);

CREATE OR REPLACE FILE FORMAT "TEST_DB"."EXTERNAL_TABLE".TEST_CSV_FILEFORMAT TYPE = 'CSV' COMPRESSION = 'AUTO' FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' SKIP_HEADER = 0 FIELD_OPTIONALLY_ENCLOSED_BY = '"' TRIM_SPACE = FALSE ERROR_ON_COLUMN_COUNT_MISMATCH = TRUE ESCAPE = 'NONE' ESCAPE_UNENCLOSED_FIELD = '\134' DATE_FORMAT = 'AUTO' TIMESTAMP_FORMAT = 'AUTO' NULL_IF = ('\\N');

```

# Upload file
```
snowsql --accountname <acountname>.west-europe.azure --dbname=TEST_DB --username martincarlsson;

list @%TEST_TABLE;

PUT file:///Users/<username>/Desktop/TEST_FILES/TEST_FILE.csv @%TEST_TABLE;
```

# COPY from table stage

```SQL
COPY INTO TEST_TABLE file_format = (format_name = 'TEST_CSV_FILEFORMAT');

SELECT * FROM "TEST_DB"."EXTERNAL_TABLE"."TEST_TABLE";
```
